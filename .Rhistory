karyogram <- fread("/Users/juliahoglund/Documents/localCADD/data/sus_scrofa_ideo")
karyogram <-
karyogram[1:21] %>%
rename(Chr = `#chrom`, Start = chromStart, End = chromEnd) %>%
select(Chr, Start, End) %>%
mutate(CE_Start = 0, CE_End = 0)
for (i in 1:nrow(karyogram)) {
karyogram[i,1] <- unlist(str_split(karyogram[i,1], "chr"))[2]
}
karyogram
ideogram(karyotype = karyogram)
load("testChromPlot.RData")
karyogram <- fread("/Users/juliahoglund/Documents/localCADD/data/sus_scrofa_ideo")
karyogram <-
karyogram[1:21] %>%
rename(Chr = `#chrom`, Start = chromStart, End = chromEnd) %>%
select(Chr, Start, End) %>%
mutate(CE_start = 0, CE_end = 0)
for (i in 1:nrow(karyogram)) {
karyogram[i,1] <- unlist(str_split(karyogram[i,1], "chr"))[2]
}
ideogram(karyotype = karyogram)
convertSVG("chromosome.svg", device = "png")
convertSVG("chromosome.svg", device = "png", width = 10, height = 9)
convertSVG("chromosome.svg", device = "png", width = 7, height = 6)
convertSVG("chromosome.svg", device = "png", width = 3, height = 6)
7
convertSVG("chromosome.svg", device = "png", width = 7, height = 6)
convertSVG("chromosome.svg", device = "png", width = 7, height = 3)
convertSVG("chromosome.svg", device = "png", width = 7, height = 4)
convertSVG("chromosome.svg", device = "png", width = 7, height = 5)
convertSVG("chromosome.svg", device = "png", width = 7, height = 6)
convertSVG("chromosome.svg", device = "png", width = 6, height = 6)
karyogram
pig_genes$Chr <- factor(pig_genes$Chr, levels = str_sort(factor(pig_genes$Chr), numeric = TRUE))
pig_genes <- data.frame(Chr = range$chrom,
Start = range$minvalue,
End = range$maxvalue,
Value = n$n)
pig_genes
karyogram <- fread("/Users/juliahoglund/Documents/localCADD/data/sus_scrofa_ideo")
karyogram <-
karyogram[1:21] %>%
rename(Chr = `#chrom`, Start = chromStart, End = chromEnd) %>%
select(Chr, Start, End) %>%
mutate(CE_start = 0, CE_end = 0)
karyogram$Chr <- factor(karyogram$Chr, levels = str_sort(factor(karyogram$Chr), numeric = TRUE))
for (i in 1:nrow(karyogram)) {
karyogram[i,1] <- unlist(str_split(karyogram[i,1], "chr"))[2]
}
karyogram
karyogram <- fread("/Users/juliahoglund/Documents/localCADD/data/sus_scrofa_ideo")
karyogram <-
karyogram[1:21] %>%
rename(Chr = `#chrom`, Start = chromStart, End = chromEnd) %>%
select(Chr, Start, End) %>%
mutate(CE_start = 0, CE_end = 0)
for (i in 1:nrow(karyogram)) {
karyogram[i,1] <- unlist(str_split(karyogram[i,1], "chr"))[2]
}
View(karyogram)
karyogram$Chr <- factor(karyogram$Chr, levels = str_sort(factor(karyogram$Chr), numeric = TRUE))
karyogram$Chr
factor(karyogram$Chr, levels = str_sort(factor(karyogram$Chr), numeric = TRUE))
factor(karyogram$Chr, levels = str_sort(factor(karyogram$Chr), numeric = TRUE)) %>%
arrange(Chr)
karyogram <- fread("/Users/juliahoglund/Documents/localCADD/data/sus_scrofa_ideo")
karyogram <-
karyogram[1:21] %>%
rename(Chr = `#chrom`, Start = chromStart, End = chromEnd) %>%
select(Chr, Start, End) %>%
mutate(CE_start = 0, CE_end = 0)
for (i in 1:nrow(karyogram)) {
karyogram[i,1] <- unlist(str_split(karyogram[i,1], "chr"))[2]
}
karyogram$Chr <-
factor(karyogram$Chr, levels = str_sort(factor(karyogram$Chr), numeric = TRUE)) %>%
karyogram %>% arrange(Chr)
karyogram %>% arrange(Chr)
karyogram %>% str_sort(Chr)
karyogram %>% str_sort(karyogram$Chr)
str_sort(karyogram$Chr)
str_sort(karyogram$Chr, numeric = TRUE)
karyogram[1:21] %>%
rename(Chr = `#chrom`, Start = chromStart, End = chromEnd) %>%
select(Chr, Start, End) %>%
mutate(CE_start = 0, CE_end = 0) %>%
arrange(Chr)
karyogram <- fread("/Users/juliahoglund/Documents/localCADD/data/sus_scrofa_ideo")
karyogram[1:21] %>%
rename(Chr = `#chrom`, Start = chromStart, End = chromEnd) %>%
select(Chr, Start, End) %>%
mutate(CE_start = 0, CE_end = 0) %>%
arrange(Chr)
karyogram[1:21] %>%
rename(Chr = `#chrom`, Start = chromStart, End = chromEnd) %>%
select(Chr, Start, End) %>%
mutate(CE_start = 0, CE_end = 0) %>%
select(where(is.numeric), where(is.character))
sort(factor(karyogram,levels=c(1:18, "X", "Y", "M"), ordered=TRUE))
karyogram
View(karyogram)
karyogram <- fread("/Users/juliahoglund/Documents/localCADD/data/sus_scrofa_ideo")
karyogram <-
karyogram[1:21] %>%
rename(Chr = `#chrom`, Start = chromStart, End = chromEnd) %>%
select(Chr, Start, End) %>%
mutate(CE_start = 0, CE_end = 0) %>%
for (i in 1:nrow(karyogram)) {
karyogram[i,1] <- unlist(str_split(karyogram[i,1], "chr"))[2]
}
karyogram <- fread("/Users/juliahoglund/Documents/localCADD/data/sus_scrofa_ideo")
karyogram <-
karyogram[1:21] %>%
rename(Chr = `#chrom`, Start = chromStart, End = chromEnd) %>%
select(Chr, Start, End) %>%
mutate(CE_start = 0, CE_end = 0)
for (i in 1:nrow(karyogram)) {
karyogram[i,1] <- unlist(str_split(karyogram[i,1], "chr"))[2]
}
View(karyogram)
sort(factor(karyogram,levels=c(1:18, "X", "Y", "M"), ordered=TRUE))
View(karyogram)
karyogram <- sort(factor(karyogram,levels=c(1:18, "X", "Y", "M"), ordered=TRUE))
karyogram <- fread("/Users/juliahoglund/Documents/localCADD/data/sus_scrofa_ideo")
karyogram <-
karyogram[1:21] %>%
rename(Chr = `#chrom`, Start = chromStart, End = chromEnd) %>%
select(Chr, Start, End) %>%
mutate(CE_start = 0, CE_end = 0)
for (i in 1:nrow(karyogram)) {
karyogram[i,1] <- unlist(str_split(karyogram[i,1], "chr"))[2]
}
karyogram$Chr <- factor(karyogram,levels=c(1:18, "X", "Y", "M"), ordered=TRUE)
karyogram <- fread("/Users/juliahoglund/Documents/localCADD/data/sus_scrofa_ideo")
karyogram <-
karyogram[1:21] %>%
rename(Chr = `#chrom`, Start = chromStart, End = chromEnd) %>%
select(Chr, Start, End) %>%
mutate(CE_start = 0, CE_end = 0)
for (i in 1:nrow(karyogram)) {
karyogram[i,1] <- unlist(str_split(karyogram[i,1], "chr"))[2]
}
karyogram$Chr <- factor(karyogram, levels=c((1:18), "X", "Y", "M"), ordered=TRUE)
View(karyogram)
karyogram <- fread("/Users/juliahoglund/Documents/localCADD/data/sus_scrofa_ideo")
karyogram <-
karyogram[1:21] %>%
rename(Chr = `#chrom`, Start = chromStart, End = chromEnd) %>%
select(Chr, Start, End) %>%
mutate(CE_start = 0, CE_end = 0)
for (i in 1:nrow(karyogram)) {
karyogram[i,1] <- unlist(str_split(karyogram[i,1], "chr"))[2]
}
karyogram$Chr <- factor(karyogram$Chr, levels=c(1:18, "X", "Y", "M"), ordered=TRUE)
karyogram %>% arrange(Chr)
karyogram <- fread("/Users/juliahoglund/Documents/localCADD/data/sus_scrofa_ideo")
karyogram <-
karyogram[1:21] %>%
rename(Chr = `#chrom`, Start = chromStart, End = chromEnd) %>%
select(Chr, Start, End) %>%
mutate(CE_start = 0, CE_end = 0)
for (i in 1:nrow(karyogram)) {
karyogram[i,1] <- unlist(str_split(karyogram[i,1], "chr"))[2]
}
karyogram$Chr <- factor(karyogram$Chr, levels=c(1:18, "X", "Y", "M"), ordered=TRUE)
karyogram <- karyogram %>% arrange(Chr)
ideogram(karyotype = karyogram)
karyogram$Chr <- as.character(karyogram$Chr)
View(karyogram)
ideogram(karyotype = karyogram)
convertSVG("chromosome.svg", device = "png", width = 6, height = 6)
convertSVG("chromosome.svg", device = "png", width = 13, height = 6)
convertSVG("chromosome.svg", device = "png", width = 3, height = 6)
convertSVG("chromosome.svg", device = "png", width = 6, height = 6)
convertSVG("chromosome.svg", device = "png", width = 6, height = 4)
convertSVG("chromosome.svg", device = "png", width = 6, height = 5)
convertSVG("chromosome.svg", device = "png", width = 6, height = 6)
convertSVG("chromosome.svg", device = "png", width = 6, height = 5)
convertSVG("chromosome.svg", device = "png", width = 7, height = 5)
convertSVG("chromosome.svg", device = "png", width = 6, height = 5)
genes <- read.table("/Users/juliahoglund/Documents/localCADD/CDS.sus_scrofa.bed", header=F)
n <-
genes %>%
mutate(bins = cut(V2, breaks = 100)) %>%
group_by(V1) %>%
count(bins)
range <-
genes %>%
mutate(bins = cut(V2, breaks = 100)) %>%
group_by(V1, bins) %>%
summarise(minvalue = min(V2), maxvalue = max(V3)) %>%
rename(chrom = V1)
pig_genes <- data.frame(Chr = range$chrom,
Start = range$minvalue,
End = range$maxvalue,
Value = n$n)
ideogram(karyotype = karyogram, overlaid = pig_genes)
convertSVG("chromosome.svg", device = "png", width = 6, height = 5)
ancestor <- read.table("/Users/juliahoglund/Documents/localCADD/Ancestor.bed", header=F)
n <-
ancestor %>%
mutate(bins = cut(V2, breaks = 100)) %>%
group_by(V1) %>%
count(bins)
range <-
ancestor %>%
mutate(bins = cut(V2, breaks = 100)) %>%
group_by(V1, bins) %>%
summarise(minvalue = min(V2), maxvalue = max(V3)) %>%
rename(chrom = V1)
ancestor_seqs <- data.frame(Chr = range$chrom,
Start = range$minvalue,
End = range$maxvalue,
Value = n$n)
ideogram(karyotype = karyogram, overlaid = pig_genes, label = ancestor_seqs, label_type = "heatmap")
convertSVG("chromosome.svg", device = "png")
#change colorset from white to color
ideogram(karyotype = karyogram,
overlaid = pig_genes,
label = ancestor_seqs,
label_type = "heatmap",
colorset1 = c("#fef2f0", "#65342c")
colorset2 = c("#f8f7fe", "#5e597c"))
#change colorset from white to color
ideogram(karyotype = karyogram,
overlaid = pig_genes,
label = ancestor_seqs,
label_type = "heatmap",
colorset1 = c("#fef2f0", "#65342c"),
colorset2 = c("#f8f7fe", "#5e597c"))
convertSVG("chromosome.svg", device = "png")
#change colorset from white to color
ideogram(karyotype = karyogram,
overlaid = pig_genes,
label = ancestor_seqs,
label_type = "heatmap",
colorset1 = c("#efe5f2", "#640080"),
colorset2 = c("#f9e6e5", "#af0900"))
convertSVG("chromosome.svg", device = "png", height = 5)
convertSVG("chromosome.svg", device = "png", height = 5, width = 3)
convertSVG("chromosome.svg", device = "png", height = 5, width = 3, dpi = 300)
#change colorset from white to color
ideogram(karyotype = karyogram,
overlaid = pig_genes,
label = ancestor_seqs,
label_type = "heatmap",
colorset1 = c("#efe5ef", "#660066"),
colorset2 = c("#fff2ed", "#ff7f50"))
convertSVG("chromosome.svg", device = "png", height = 5, width = 5, dpi = 300)
??convertSVG
ls()
data(Pi_for_CE, package="RIdeogram") #load the Pi data for one-line label
head(Pi_for_CE)
View(Pi_for_CE)
data(liriodendron_karyotype, package="RIdeogram") #load the karyotype data
data(Fst_between_CE_and_CW, package="RIdeogram") #load the Fst data for overlaid heatmap
data(Pi_for_CE, package="RIdeogram") #load the Pi data for one-line label
head(Pi_for_CE)
ideogram(karyotype = liriodendron_karyotype, overlaid = Fst_between_CE_and_CW, label = Pi_for_CE, label_type = "line", colorset1 = c("#e5f5f9", "#99d8c9", "#2ca25f"))
convertSVG("chromosome.svg", device = "png")
overlap <- read.table("/Users/juliahoglund/Documents/localCADD/coverage.CDS.chr1.bed", header=F)
overlap <- read.table("/Users/juliahoglund/Documents/localCADD/coverage.CDS.bed", header=F)
colnames(overlap) <- c("Chr", "Start", "End", "Depth", "BasesAtSite", "SizeOfA", "Value")
overlap %>% select(Chr, Start, End, Value) %>%
mutate(bins = cut(Value, breaks = 100)) %>% group_by(Chr, bins) %>%
summarise(minvalue = min(Start), maxvalue = max(End), overlap = sum(Value))
overlap %>% select(Chr, Start, End, Value) %>%
mutate(bins = cut(Value, breaks = 100)) %>% group_by(Chr, bins) %>%
summarise(minvalue = min(Start), maxvalue = max(End), overlap = sum(Value)) %>%
mutate(Color = "fc8d62")
overlap %>% select(Chr, Start, End, Value) %>%
mutate(bins = cut(Value, breaks = 100)) %>% group_by(Chr, bins) %>%
summarise(minvalue = min(Start), maxvalue = max(End), overlap = sum(Value)) %>%
mutate(Color = "fc8d62") %>% select(Chr, minvalue, maxvalue, overlap, Color) %>%
rename(Start = minvalue, End = maxvalue, Value = overlap)
overlap <-
overlap %>% select(Chr, Start, End, Value) %>%
mutate(bins = cut(Value, breaks = 100)) %>% group_by(Chr, bins) %>%
summarise(minvalue = min(Start), maxvalue = max(End), overlap = sum(Value)) %>%
mutate(Color = "fc8d62") %>% select(Chr, minvalue, maxvalue, overlap, Color) %>%
rename(Start = minvalue, End = maxvalue, Value = overlap) %>%
as.data.frame(.)
head(overlap)
View(overlap)
ideogram(karyotype = karyogram, overlaid = pig_genes, label = overlap, label_type = "polygon")
convertSVG("chromosome.svg", device = "png", width = 6, height = 5)
ideogram(karyotype = karyogram, overlaid = pig_genes, label = overlap, label_type = "line")
convertSVG("chromosome.svg", device = "png", width = 6, height = 5)
table(overlap$Chr)
overlap %>% select(Chr, Start, End, Value) %>%
mutate(bins = cut(Value, breaks = 100)) %>% group_by(Chr, bins) %>%
summarise(minvalue = min(Start), maxvalue = max(End), overlap = sum(Value)) %>%
mutate(Color = "fc8d62") %>% select(Chr, minvalue, maxvalue, overlap, Color) %>%
rename(Start = minvalue, End = maxvalue, Value = overlap) %>%
arrange(Chr)
as.data.frame(.)
overlap <- read.table("/Users/juliahoglund/Documents/localCADD/coverage.CDS.bed", header=F)
colnames(overlap) <- c("Chr", "Start", "End", "Depth", "BasesAtSite", "SizeOfA", "Value")
overlap %>% select(Chr, Start, End, Value) %>%
mutate(bins = cut(Value, breaks = 100)) %>% group_by(Chr, bins) %>%
summarise(minvalue = min(Start), maxvalue = max(End), overlap = sum(Value)) %>%
mutate(Color = "fc8d62") %>% select(Chr, minvalue, maxvalue, overlap, Color) %>%
rename(Start = minvalue, End = maxvalue, Value = overlap) %>%
arrange(Chr) %>%
as.data.frame(.)
overlap %>% select(Chr, Start, End, Value) %>%
mutate(bins = cut(Value, breaks = 100)) %>% group_by(Chr, bins) %>%
summarise(minvalue = min(Start), maxvalue = max(End), overlap = sum(Value)) %>%
mutate(Color = "fc8d62") %>% select(Chr, minvalue, maxvalue, overlap, Color) %>%
rename(Start = minvalue, End = maxvalue, Value = overlap) %>%
arrange(as.numeric(Chr)) %>%
as.data.frame(.)
overlap <-
overlap %>% select(Chr, Start, End, Value) %>%
mutate(bins = cut(Value, breaks = 100)) %>% group_by(Chr, bins) %>%
summarise(minvalue = min(Start), maxvalue = max(End), overlap = sum(Value)) %>%
mutate(Color = "fc8d62") %>% select(Chr, minvalue, maxvalue, overlap, Color) %>%
rename(Start = minvalue, End = maxvalue, Value = overlap) %>%
arrange(as.numeric(Chr)) %>%
as.data.frame(.)
table(overlap$Chr, useNA = "always")
overlap <-
overlap %>% select(Chr, Start, End, Value) %>%
mutate(bins = cut(Value, breaks = 100)) %>% group_by(Chr, bins) %>%
summarise(minvalue = min(Start), maxvalue = max(End), overlap = sum(Value)) %>%
mutate(Color = "fc8d62") %>% select(Chr, minvalue, maxvalue, overlap, Color) %>%
rename(Start = minvalue, End = maxvalue, Value = overlap) %>%
arrange(as.numeric(Chr))
table(overlap$Chr, useNA = "always")
overlap <- read.table("/Users/juliahoglund/Documents/localCADD/coverage.CDS.bed", header=F)
colnames(overlap) <- c("Chr", "Start", "End", "Depth", "BasesAtSite", "SizeOfA", "Value")
overlap <-
overlap %>% select(Chr, Start, End, Value) %>%
mutate(bins = cut(Value, breaks = 100)) %>% group_by(Chr, bins) %>%
summarise(minvalue = min(Start), maxvalue = max(End), overlap = sum(Value)) %>%
mutate(Color = "fc8d62") %>% select(Chr, minvalue, maxvalue, overlap, Color) %>%
rename(Start = minvalue, End = maxvalue, Value = overlap) %>%
arrange(as.numeric(Chr))
table(overlap$Chr, useNA = "always")
overlap <- read.table("/Users/juliahoglund/Documents/localCADD/coverage.CDS.bed", header=F)
colnames(overlap) <- c("Chr", "Start", "End", "Depth", "BasesAtSite", "SizeOfA", "Value")
overlap <-
overlap %>% select(Chr, Start, End, Value) %>%
mutate(bins = cut(Value, breaks = 100)) %>% group_by(Chr, bins) %>%
summarise(minvalue = min(Start), maxvalue = max(End), overlap = sum(Value)) %>%
mutate(Color = "fc8d62") %>% select(Chr, minvalue, maxvalue, overlap, Color) %>%
rename(Start = minvalue, End = maxvalue, Value = overlap) %>%
arrange(Chr)
table(overlap$Chr, useNA = "always")
overlap <- read.table("/Users/juliahoglund/Documents/localCADD/coverage.CDS.bed", header=F)
colnames(overlap) <- c("Chr", "Start", "End", "Depth", "BasesAtSite", "SizeOfA", "Value")
overlap <-
overlap %>% select(Chr, Start, End, Value) %>%
mutate(bins = cut(Value, breaks = 100)) %>% group_by(Chr, bins) %>%
summarise(minvalue = min(Start), maxvalue = max(End), overlap = sum(Value)) %>%
mutate(Color = "fc8d62") %>% select(Chr, minvalue, maxvalue, overlap, Color) %>%
rename(Start = minvalue, End = maxvalue, Value = overlap) %>%
as.data.frame(.)
overlap$Chr <- factor(overlap$Chr, levels=c(1:18, "X"), ordered=TRUE)
overlap <- overlap %>% arrange(Chr)
overlap$Chr <- as.character(overlap$Chr)
table(overlap$Chr)
overlap$Chr <- factor(overlap$Chr, levels=c(1:18, "X"), ordered=TRUE)
table(overlap$Chr)
overlap <- overlap %>% arrange(Chr)
table(overlap$Chr)
overlap$Chr <- as.character(overlap$Chr)
table(overlap$Chr)
overlap <- read.table("/Users/juliahoglund/Documents/localCADD/coverage.CDS.bed", header=F)
colnames(overlap) <- c("Chr", "Start", "End", "Depth", "BasesAtSite", "SizeOfA", "Value")
overlap <-
overlap %>% select(Chr, Start, End, Value) %>%
mutate(bins = cut(Value, breaks = 100)) %>% group_by(Chr, bins) %>%
summarise(minvalue = min(Start), maxvalue = max(End), overlap = sum(Value)) %>%
mutate(Color = "fc8d62") %>% select(Chr, minvalue, maxvalue, overlap, Color) %>%
rename(Start = minvalue, End = maxvalue, Value = overlap) %>%
as.data.frame(.)
overlap$Chr <- factor(overlap$Chr, levels=c(1:18, "X"), ordered=TRUE)
overlap <- overlap %>% arrange(Chr)
ideogram(karyotype = karyogram, overlaid = pig_genes, label = overlap, label_type = "line")
convertSVG("chromosome.svg", device = "png", width = 6, height = 5)
overlap <- overlap %>% arrange(Chr, Start)
ideogram(karyotype = karyogram, overlaid = pig_genes, label = overlap, label_type = "line")
convertSVG("chromosome.svg", device = "png", width = 6, height = 5)
overlap <- read.table("/Users/juliahoglund/Documents/localCADD/coverage.CDS.bed", header=F)
colnames(overlap) <- c("Chr", "Start", "End", "Depth", "BasesAtSite", "SizeOfA", "Value")
overlap <-
overlap %>% select(Chr, Start, End, Value) %>%
mutate(bins = cut(Value, breaks = 10000)) %>% group_by(Chr, bins) %>%
summarise(minvalue = min(Start), maxvalue = max(End), overlap = sum(Value)) %>%
mutate(Color = "0a2e54") %>% select(Chr, minvalue, maxvalue, overlap, Color) %>%
rename(Start = minvalue, End = maxvalue, Value = overlap) %>%
as.data.frame(.)
overlap$Chr <- factor(overlap$Chr, levels=c(1:18, "X"), ordered=TRUE)
overlap <- overlap %>% arrange(Chr, Start)
ideogram(karyotype = karyogram, overlaid = pig_genes, label = overlap, label_type = "line")
overlap <- read.table("/Users/juliahoglund/Documents/localCADD/coverage.CDS.bed", header=F)
colnames(overlap) <- c("Chr", "Start", "End", "Depth", "BasesAtSite", "SizeOfA", "Value")
overlap <-
overlap %>% select(Chr, Start, End, Value) %>%
mutate(bins = cut(Value, breaks = 100)) %>% group_by(Chr, bins) %>%
summarise(minvalue = min(Start), maxvalue = max(End), overlap = mean(Value)) %>%
mutate(Color = "0a2e54") %>% select(Chr, minvalue, maxvalue, overlap, Color) %>%
rename(Start = minvalue, End = maxvalue, Value = overlap) %>%
as.data.frame(.)
View(overlap)
overlap$Chr <- factor(overlap$Chr, levels=c(1:18, "X"), ordered=TRUE)
overlap <- overlap %>% arrange(Chr, Start)
ideogram(karyotype = karyogram, overlaid = pig_genes, label = overlap, label_type = "line")
convertSVG("chromosome.svg", device = "png", width = 6, height = 5, dpi = 300)
ideogram(karyotype = karyogram, overlaid = pig_genes, label = overlap, label_type = "polygon")
convertSVG("chromosome.svg", device = "png", width = 6, height = 5, dpi = 300)
ideogram(karyotype = karyogram,
overlaid = pig_genes,
label = ancestor_seqs,
label_type = "heatmap",
colorset1 = c("#efe5ef", "#a366a3", "#660066"),
colorset2 = c("#fff2ed", "#ffb296", "#ff7f50"))
overlap <-
overlap %>% select(Chr, Start, End, Value) %>%
mutate(bins = cut(Value, breaks = 100)) %>% group_by(bins) %>%
summarise(minvalue = min(Start), maxvalue = max(End), overlap = mean(Value))
overlap <- read.table("/Users/juliahoglund/Documents/localCADD/coverage.CDS.bed", header=F)
colnames(overlap) <- c("Chr", "Start", "End", "Depth", "BasesAtSite", "SizeOfA", "Value")
overlap %>% select(Chr, Start, End, Value) %>%
mutate(bins = cut(Value, breaks = 100)) %>% group_by(bins) %>%
summarise(minvalue = min(Start), maxvalue = max(End), overlap = mean(Value))
overlap %>% select(Chr, Start, End, Value) %>%
mutate(bins = cut(Value, breaks = 100)) %>% group_by(bins, Chr) %>%
summarise(minvalue = min(Start), maxvalue = max(End), overlap = mean(Value))
overlap %>% select(Chr, Start, End, Value) %>%
mutate(bins = cut(Start, breaks = 100)) %>% group_by(bins, Chr) %>%
summarise(minvalue = min(Start), maxvalue = max(End), overlap = mean(Value))
overlap <-
overlap %>% select(Chr, Start, End, Value) %>%
mutate(bins = cut(Start, breaks = 100)) %>% group_by(bins, Chr) %>%
summarise(minvalue = min(Start), maxvalue = max(End), overlap = mean(Value)) %>%
mutate(Color = "0a2e54") %>% select(Chr, minvalue, maxvalue, overlap, Color) %>%
rename(Start = minvalue, End = maxvalue, Value = overlap) %>%
as.data.frame(.)
View(overlap)
overlap$Chr <- factor(overlap$Chr, levels=c(1:18, "X"), ordered=TRUE)
overlap <- overlap %>% arrange(Chr, Start)
overlap %>%
select(Chr, Start, End, Value) %>%
mutate(bins = cut(Start, breaks = 100)) %>%
group_by(bins, Chr) %>%
summarise(minvalue = min(Start), maxvalue = max(End), overlap = mean(Value)) %>%
mutate(Color = "0a2e54") %>%
select(Chr, minvalue, maxvalue, overlap, Color)
overlap %>%
select(Chr, Start, End, Value) %>%
mutate(bins = cut(Start, breaks = 100)) %>%
group_by(bins, Chr) %>%
summarise(minvalue = min(Start), maxvalue = max(End), overlap = mean(Value)) %>%
mutate(Color = "0a2e54") %>%
select(Chr, minvalue, maxvalue, overlap, Color) %>%
rename(Start = minvalue, End = maxvalue, Value = overlap)
ideogram(karyotype = karyogram, overlaid = pig_genes, label = overlap, label_type = "polygon")
convertSVG("chromosome.svg", device = "png", width = 6, height = 5, dpi = 300)
overlap$Chr <- factor(overlap$Chr, levels=c(1:18, "X"), ordered=TRUE)
overlap <- overlap %>% arrange(Chr, Start) %>% select(-bins)
View(overlap)
ideogram(karyotype = karyogram, overlaid = pig_genes, label = overlap, label_type = "polygon", colorset1 = c("#efe5ef", "#a366a3", "#660066"))
convertSVG("chromosome.svg", device = "png", width = 6, height = 5, dpi = 300)
convertSVG("anc-coverage.svg", device = "png", width = 7, height = 6, dpi = 300)
ideogram(karyotype = karyogram, overlaid = pig_genes, label = overlap, label_type = "polygon", colorset1 = c("#efe5ef", "#a366a3", "#660066"))
convertSVG("anc-coverage.svg", device = "png", width = 7, height = 6, dpi = 300)
convertSVG(file = "anc-coverage.svg", device = "png", width = 6, height = 5, dpi = 300)
convertSVG(svg = "chromosome.svg", file = "anc-coverage.svg", device = "png", width = 6, height = 5, dpi = 300)
convertSVG(svg = "anc-coverage.svg", file = "anc-coverage", device = "png", width = 6, height = 5, dpi = 300)
ideogram(karyotype = karyogram, overlaid = pig_genes, label = overlap, label_type = "polygon", colorset1 = c("#efe5ef", "#a366a3", "#660066"))
convertSVG(svg = "chromosome.svg", file = "anc-coverage", device = "png", width = 6, height = 5, dpi = 300)
ideogram(karyotype = karyogram,
overlaid = pig_genes,
label = overlap,
label_type = "polygon",
colorset1 = c("#efe5ef", "#a366a3", "#660066"),
output = "anc-coverage.svg")
convertSVG(svg = "anc-coverage.svg", file = "anc-coverage", device = "png", width = 6, height = 5, dpi = 300)
ideogram(karyotype = karyogram,
overlaid = pig_genes,
label = ancestor_seqs,
label_type = "heatmap",
colorset1 = c("#efe5ef", "#a366a3", "#660066"),
colorset2 = c("#fff2ed", "#ffb296", "#ff7f50"),
output = "anc-seq.svg")
convertSVG(svg = "anc-seq.svg", file = "anc-seq", device = "png", width = 6, height = 5, dpi = 300)
karyogram <- fread("/Users/juliahoglund/Documents/localCADD/data/sus_scrofa_ideo")
karyogram <-
karyogram[1:21] %>%
# change to desired number of chromosomes
rename(Chr = `#chrom`, Start = chromStart, End = chromEnd) %>%
select(Chr, Start, End) %>%
# centromere data, needed even if absent
mutate(CE_start = 0, CE_end = 0)
karyogram <- fread("/Users/juliahoglund/Documents/localCADD/data/sus_scrofa_ideo")
karyogram <-
karyogram[1:21]
karyogram <- fread("/Users/juliahoglund/Documents/localCADD/data/sus_scrofa_ideo")
karyogram[1:21]
karyogram <-
karyogram[1:21,]
karyogram <- fread("/Users/juliahoglund/Documents/localCADD/data/sus_scrofa_ideo")
karyogram[1:21,]
install.packages("renv")
library(renv)
setwd("/Users/juliahoglund/Documents/GitHub/omniCADD/config/")
renv::init()
setwd("/Users/juliahoglund/Documents/GitHub/omniCADD/")
renv::init()
